"use strict";(self["webpackChunkweek6_homework"]=self["webpackChunkweek6_homework"]||[]).push([[347],{6347:function(e,s,n){n.r(s),n.d(s,{default:function(){return q}});var t=n(3396),o=n(9242);const a={class:"container"},r={class:"row d-flex justify-content-center"},i=(0,t._)("h1",{class:"h3 mb-3 font-weight-normal"}," 請先登入 ",-1),l={class:"col-8"},d={class:"form-floating mb-3"},u=["disabled"],c=(0,t._)("label",{for:"username"},"Email address",-1),m={class:"form-floating"},p=["disabled"],f=(0,t._)("label",{for:"password"},"Password",-1),h=["disabled"],b=(0,t.Uk)(" 登入 "),w={key:0,class:"spinner-border ms-2",role:"status"},g=(0,t._)("span",{class:"visually-hidden"},"Loading...",-1),v=[g],_=(0,t._)("div",{id:"loginResult"},null,-1),k=(0,t._)("p",{class:"mt-5 mb-3 text-muted"}," © 2022~∞ - 六角學院 ",-1);function y(e,s,n,g,y,I){return(0,t.wg)(),(0,t.iD)("div",a,[(0,t._)("div",r,[i,(0,t._)("div",l,[(0,t._)("form",{id:"form",class:"form-signin",onSubmit:s[2]||(s[2]=(0,o.iM)(((...e)=>I.login&&I.login(...e)),["prevent"]))},[(0,t._)("div",d,[(0,t.wy)((0,t._)("input",{type:"email",class:"form-control",id:"username",placeholder:"name@example.com","onUpdate:modelValue":s[0]||(s[0]=e=>y.userInfo.username=e),disabled:y.isLoading,required:"",autofocus:""},null,8,u),[[o.nr,y.userInfo.username]]),c]),(0,t._)("div",m,[(0,t.wy)((0,t._)("input",{type:"password",class:"form-control",id:"password",placeholder:"Password","onUpdate:modelValue":s[1]||(s[1]=e=>y.userInfo.password=e),disabled:y.isLoading,required:""},null,8,p),[[o.nr,y.userInfo.password]]),f]),(0,t._)("button",{class:"btn btn-lg btn-primary w-100 mt-3",type:"submit",disabled:y.isLoading},[b,y.isLoading?((0,t.wg)(),(0,t.iD)("div",w,v)):(0,t.kq)("",!0)],8,h)],32)])]),_,k])}var I=n(8937),L={data(){return{userInfo:{username:"",password:""},isLoading:!1}},methods:{login(){const e=""===this.userInfo.username,s=""===this.userInfo.password;if(e||s)return void this.alert("需填入帳號和密碼資料，登入失敗","danger");this.isLoading=!0;const n={username:this.userInfo.username,password:this.userInfo.password};this.$http.post("https://vue3-course-api.hexschool.io/v2/admin/signin",n).then((e=>{if(200===e.status){const{expired:s,token:n}=e.data;document.cookie=`hexToken=${n};expires=${new Date(s)}; path=/`,this.$router.push("/admin/products")}else this.alert("帳號密碼錯誤，登入失敗","danger")})).catch((e=>{console.error(e),this.alert("帳號密碼錯誤，登入失敗","danger")})).finally((()=>{this.isLoading=!1}))},alert(e,s){const n=document.getElementById("loginResult"),t=document.createElement("div");t.innerHTML=`\n        <div class="alert alert-${s} alert-dismissible" role="alert"> \n          ${e} <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>\n        </div>\n      `,n.append(t),setTimeout((()=>{const e=document.querySelector(".alert"),s=new I["default"].Alert(e);e&&s&&s.close()}),3e3)}}},x=n(89);const $=(0,x.Z)(L,[["render",y]]);var q=$}}]);
//# sourceMappingURL=347.158d0da9.js.map