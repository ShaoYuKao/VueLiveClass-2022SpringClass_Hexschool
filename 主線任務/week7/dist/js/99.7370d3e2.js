"use strict";(self["webpackChunkweek7_homework"]=self["webpackChunkweek7_homework"]||[]).push([[99],{9099:function(t,e,a){a.r(e),a.d(e,{default:function(){return re}});var l=a(3396),s=a(7139);const o=(0,l._)("h2",null,"後台產品頁面",-1),d={class:"container"},i={class:"text-end mt-4"},r={class:"table mt-4"},n=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",{width:"50"}," # "),(0,l._)("th",{width:"120"}," 分類 "),(0,l._)("th",null,"產品名稱"),(0,l._)("th",{width:"120",class:"text-end"}," 原價 "),(0,l._)("th",{width:"120",class:"text-end"}," 售價 "),(0,l._)("th",{width:"100",class:"text-center"}," 是否啟用 "),(0,l._)("th",{width:"120",class:"text-center"}," 編輯 ")])],-1),c={class:"text-end"},p={class:"text-end"},u={class:"text-center"},m={key:0,class:"text-success fw-bold"},g={key:1,class:"text-danger fw-bold"},h={class:"btn-group"},b=["onClick"],_=["onClick"];function f(t,e,a,f,P,y){const v=(0,l.up)("Pagination"),w=(0,l.up)("ProductAddModal"),k=(0,l.up)("ProductDelModal");return(0,l.wg)(),(0,l.iD)(l.HY,null,[o,(0,l._)("div",d,[(0,l._)("div",i,[(0,l._)("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=t=>y.openModal(P.stateMode.add))}," 建立新的產品 ")]),(0,l._)("table",r,[n,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(P.products,((t,e)=>((0,l.wg)(),(0,l.iD)("tr",{key:t.id},[(0,l._)("td",null,(0,s.zw)(10*P.currentPage-10+e+1),1),(0,l._)("td",null,(0,s.zw)(t.category),1),(0,l._)("td",null,(0,s.zw)(t.title),1),(0,l._)("td",c,(0,s.zw)(t.origin_price),1),(0,l._)("td",p,(0,s.zw)(t.price),1),(0,l._)("td",u,[t.is_enabled>0?((0,l.wg)(),(0,l.iD)("span",m,"啟用")):(0,l.kq)("",!0),t.is_enabled<=0||!t.is_enabled?((0,l.wg)(),(0,l.iD)("span",g," 未啟用 ")):(0,l.kq)("",!0)]),(0,l._)("td",null,[(0,l._)("div",h,[(0,l._)("button",{type:"button",class:"btn btn-outline-primary btn-sm me-1",onClick:e=>y.openModal(P.stateMode.edit,t)}," 編輯 ",8,b),(0,l._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:e=>y.openModal(P.stateMode.delete,t)}," 刪除 ",8,_)])])])))),128))])]),(0,l.Wm)(v,{pages:P.pagination},null,8,["pages"]),(0,l.Wm)(w,{ref:"productAddModal",state:P.state,"state-mode":P.stateMode,"temp-product":P.tempProduct,"current-page":P.pagination.current_page},null,8,["state","state-mode","temp-product","current-page"]),(0,l.Wm)(k,{ref:"productDelModal","temp-product":P.tempProduct,"current-page":P.pagination.current_page},null,8,["temp-product","current-page"])])],64)}var P=a(422),y=a(9242);const v={"aria-label":"Page navigation example"},w={class:"pagination"},k=(0,l._)("span",{"aria-hidden":"true"},"«",-1),M=[k],U={key:0,class:"page-link"},x=["onClick"],D=(0,l._)("span",{"aria-hidden":"true"},"»",-1),Z=[D];function C(t,e,a,o,d,i){return(0,l.wg)(),(0,l.iD)("nav",v,[(0,l._)("ul",w,[(0,l._)("li",{class:(0,s.C_)(["page-item",{disabled:1===a.pages.current_page}])},[(0,l._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:e[0]||(e[0]=(0,y.iM)((t=>i.changePages(a.pages.current_page-1)),["prevent"]))},M)],2),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.pages.total_pages,((t,e)=>((0,l.wg)(),(0,l.iD)("li",{key:e,class:(0,s.C_)(["page-item",{active:t===a.pages.current_page}])},[t===a.pages.current_page?((0,l.wg)(),(0,l.iD)("span",U,(0,s.zw)(t),1)):((0,l.wg)(),(0,l.iD)("a",{key:1,class:"page-link",href:"#",onClick:(0,y.iM)((e=>i.changePages(t)),["prevent"])},(0,s.zw)(t),9,x))],2)))),128)),(0,l._)("li",{class:(0,s.C_)(["page-item",{disabled:a.pages.current_page===a.pages.total_pages}])},[(0,l._)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:e[1]||(e[1]=(0,y.iM)((t=>i.changePages(a.pages.current_page+1)),["prevent"]))},Z)],2)])])}var $={props:["pages"],methods:{changePages(t){P.Z.emit("changePagesHandler",t)}}},I=a(89);const F=(0,I.Z)($,[["render",C]]);var L=F;const z={id:"productModal",ref:"productModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},V={class:"modal-dialog modal-xl"},A={class:"modal-content border-0"},H={class:"modal-header bg-dark text-white"},q={id:"productModalLabel",class:"modal-title"},Y={key:0},K={key:1},N=(0,l._)("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),W={class:"modal-body"},J={class:"row"},O=(0,l._)("p",{class:"text-center text-danger"},[(0,l._)("span",{class:"fs-4"},"*"),(0,l.Uk)(" 符號為必填欄位 ")],-1),S={class:"col-sm-4"},E={class:"mb-2"},j={class:"mb-3"},B=(0,l._)("label",{for:"imageUrl",class:"form-label"},"輸入主圖片網址",-1),G=["src"],Q=(0,l._)("hr",null,null,-1),R=(0,l._)("h3",{class:"mb-3"},"新增其他圖片",-1),T={key:0},X={class:"mb-3"},tt=(0,l._)("label",{for:"imageUrl",class:"form-label"},"圖片網址",-1),et=["onUpdate:modelValue"],at=["src"],lt=["onClick"],st=["disabled"],ot={class:"col-sm-8"},dt={class:"mb-3"},it={for:"title",class:"form-label"},rt=(0,l._)("span",{class:"text-danger fs-4"},"*",-1),nt=["placeholder"],ct={class:"row"},pt={class:"mb-3 col-md-6"},ut={for:"category",class:"form-label"},mt=(0,l._)("span",{class:"text-danger fs-4"},"*",-1),gt=["placeholder"],ht={class:"mb-3 col-md-6"},bt={for:"price",class:"form-label"},_t=(0,l._)("span",{class:"text-danger fs-4"},"*",-1),ft=["placeholder"],Pt={class:"row"},yt={class:"mb-3 col-md-6"},vt={for:"origin_price",class:"form-label"},wt=(0,l._)("span",{class:"text-danger fs-4"},"*",-1),kt=["placeholder"],Mt={class:"mb-3 col-md-6"},Ut={for:"price",class:"form-label"},xt=(0,l._)("span",{class:"text-danger fs-4"},"*",-1),Dt=["placeholder"],Zt=(0,l._)("hr",null,null,-1),Ct={class:"mb-3"},$t=(0,l._)("label",{for:"description",class:"form-label"},"產品描述",-1),It={class:"mb-3"},Ft=(0,l._)("label",{for:"content",class:"form-label"},"說明內容",-1),Lt={class:"mb-3"},zt={class:"form-check"},Vt=(0,l._)("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),At={class:"modal-footer"},Ht=(0,l._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function qt(t,e,a,o,d,i){return(0,l.wg)(),(0,l.iD)("div",z,[(0,l._)("div",V,[(0,l._)("div",A,[(0,l._)("div",H,[(0,l._)("h5",q,[a.state===t.stateMode.add?((0,l.wg)(),(0,l.iD)("span",Y,"新增產品")):(0,l.kq)("",!0),a.state===t.stateMode.edit?((0,l.wg)(),(0,l.iD)("span",K,"編輯產品")):(0,l.kq)("",!0)]),N]),(0,l._)("div",W,[(0,l._)("div",J,[O,(0,l._)("div",S,[(0,l._)("div",E,[(0,l._)("div",j,[B,(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":e[0]||(e[0]=e=>t.tempProduct.imageUrl=e),type:"text",class:"form-control mb-2",placeholder:"請輸入圖片連結"},null,512),[[y.nr,t.tempProduct.imageUrl]]),t.tempProduct.imageUrl&&t.tempProduct.imageUrl.length>0?((0,l.wg)(),(0,l.iD)("img",{key:0,class:"img-fluid",src:t.tempProduct.imageUrl,alt:"主要圖片"},null,8,G)):(0,l.kq)("",!0)]),Q,R,Array.isArray(t.tempProduct.imagesUrl)?((0,l.wg)(),(0,l.iD)("div",T,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.tempProduct.imagesUrl,((e,a)=>((0,l.wg)(),(0,l.iD)("div",{class:"mb-1",key:a},[(0,l._)("div",X,[tt,(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":e=>t.tempProduct.imagesUrl[a]=e,type:"text",class:"form-control",placeholder:"請輸入圖片連結"},null,8,et),[[y.nr,t.tempProduct.imagesUrl[a]]])]),(0,l._)("img",{class:"img-fluid",src:e,alt:"新增其他圖片"},null,8,at),(0,l._)("button",{class:"btn btn-outline-danger btn-sm d-block w-100 mt-1",onClick:e=>t.tempProduct.imagesUrl.splice(a,1)}," 刪除圖片 ",8,lt)])))),128))])):(0,l.kq)("",!0)]),(0,l._)("div",null,[(0,l._)("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[1]||(e[1]=t=>i.createImages()),disabled:i.isDisabledAddImg()}," 新增圖片 ",8,st)])]),(0,l._)("div",ot,[(0,l._)("div",dt,[(0,l._)("label",it,[rt,(0,l.Uk)(" "+(0,s.zw)(d.productFieldInfo.title),1)]),(0,l.wy)((0,l._)("input",{id:"title",type:"text",class:"form-control",placeholder:`請輸入${d.productFieldInfo.title}`,"onUpdate:modelValue":e[2]||(e[2]=e=>t.tempProduct.title=e)},null,8,nt),[[y.nr,t.tempProduct.title]])]),(0,l._)("div",ct,[(0,l._)("div",pt,[(0,l._)("label",ut,[mt,(0,l.Uk)(" "+(0,s.zw)(d.productFieldInfo.category),1)]),(0,l.wy)((0,l._)("input",{id:"category",type:"text",class:"form-control",placeholder:`請輸入${d.productFieldInfo.category}`,"onUpdate:modelValue":e[3]||(e[3]=e=>t.tempProduct.category=e)},null,8,gt),[[y.nr,t.tempProduct.category]])]),(0,l._)("div",ht,[(0,l._)("label",bt,[_t,(0,l.Uk)(" "+(0,s.zw)(d.productFieldInfo.unit),1)]),(0,l.wy)((0,l._)("input",{id:"unit",type:"text",class:"form-control",placeholder:`請輸入${d.productFieldInfo.unit}`,"onUpdate:modelValue":e[4]||(e[4]=e=>t.tempProduct.unit=e)},null,8,ft),[[y.nr,t.tempProduct.unit]])])]),(0,l._)("div",Pt,[(0,l._)("div",yt,[(0,l._)("label",vt,[wt,(0,l.Uk)(" "+(0,s.zw)(d.productFieldInfo.origin_price),1)]),(0,l.wy)((0,l._)("input",{id:"origin_price",type:"number",min:"0",class:"form-control",placeholder:`請輸入${d.productFieldInfo.origin_price}`,"onUpdate:modelValue":e[5]||(e[5]=e=>t.tempProduct.origin_price=e)},null,8,kt),[[y.nr,t.tempProduct.origin_price,void 0,{number:!0}]])]),(0,l._)("div",Mt,[(0,l._)("label",Ut,[xt,(0,l.Uk)((0,s.zw)(d.productFieldInfo.price),1)]),(0,l.wy)((0,l._)("input",{id:"price",type:"number",min:"0",class:"form-control",placeholder:`請輸入${d.productFieldInfo.price}`,"onUpdate:modelValue":e[6]||(e[6]=e=>t.tempProduct.price=e)},null,8,Dt),[[y.nr,t.tempProduct.price,void 0,{number:!0}]])])]),Zt,(0,l._)("div",Ct,[$t,(0,l.wy)((0,l._)("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入產品描述","onUpdate:modelValue":e[7]||(e[7]=e=>t.tempProduct.description=e)},"\n                ",512),[[y.nr,t.tempProduct.description]])]),(0,l._)("div",It,[Ft,(0,l.wy)((0,l._)("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入說明內容","onUpdate:modelValue":e[8]||(e[8]=e=>t.tempProduct.content=e)},"\n                ",512),[[y.nr,t.tempProduct.content]])]),(0,l._)("div",Lt,[(0,l._)("div",zt,[(0,l.wy)((0,l._)("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":e[9]||(e[9]=e=>t.tempProduct.is_enabled=e)},null,512),[[y.e8,t.tempProduct.is_enabled]]),Vt])])])])]),(0,l._)("div",At,[Ht,(0,l._)("button",{type:"button",class:"btn btn-primary",onClick:e[10]||(e[10]=(...t)=>i.updateProduct&&i.updateProduct(...t))}," 確認 ")])])])],512)}var Yt=a(7972),Kt=a.n(Yt);const Nt={get:"get",post:"post",put:"put",delete:"delete"};var Wt={props:["state","state-mode","temp-product","current-page"],data(){return{productFieldInfo:{title:"標題",category:"分類",unit:"單位",origin_price:"原價",price:"售價"}}},template:"#productModal",methods:{createImages(){this.tempProduct.imageUrl&&this.tempProduct.imageUrl.length>0?this.tempProduct.imagesUrl?this.tempProduct.imagesUrl.push(""):this.tempProduct.imagesUrl=[""]:P.Z.emit("push-message",{style:"danger",title:"錯誤訊息",content:"請先輸入輸入主圖片網址"})},isDisabledAddImg(){let t=!1;return this.tempProduct&&this.tempProduct.imagesUrl&&this.tempProduct.imagesUrl.length>0&&this.tempProduct.imagesUrl[this.tempProduct.imagesUrl.length-1].length<=0&&(t=!0),t},updateProduct(){let t="",e="";if(this.state===this.stateMode.add?(t="https://vue3-course-api.hexschool.io/v2/api/202201-vue-shaoyu/admin/product",e=Nt.post):this.state===this.stateMode.edit&&(t=`https://vue3-course-api.hexschool.io/v2/api/202201-vue-shaoyu/admin/product/${this.tempProduct.id}`,e=Nt.put),t&&e)if(this.tempProduct.title)if(this.tempProduct.category)if(this.tempProduct.unit)if(this.tempProduct.origin_price)if(this.tempProduct.price){if(this.tempProduct.is_enabled||(this.tempProduct.is_enabled=!1),P.Z.emit("Loading",!0),this.tempProduct.imagesUrl&&this.tempProduct.imagesUrl.length>0){const t=this.tempProduct.imagesUrl;t.forEach(((e,a)=>{e.length<=0&&t.splice(a,1)}))}this.$http[e](t,{data:this.tempProduct}).then((t=>{P.Z.emit("push-message",{style:"danger",title:"更新成功",content:t.data.message}),this.closeModal(),P.Z.emit("changePagesHandler",this.currentPage)})).catch((t=>{P.Z.emit("push-message",{style:"danger",title:"錯誤訊息",content:t.data.message})})).finally((()=>{P.Z.emit("Loading",!1)}))}else P.Z.emit("push-message",{style:"danger",title:"錯誤訊息",content:`請輸入${this.productFieldInfo.price}`});else P.Z.emit("push-message",{style:"danger",title:"錯誤訊息",content:`請輸入${this.productFieldInfo.origin_price}`});else P.Z.emit("push-message",{style:"danger",title:"錯誤訊息",content:`請輸入${this.productFieldInfo.unit}`});else P.Z.emit("push-message",{style:"danger",title:"錯誤訊息",content:`請輸入${this.productFieldInfo.category}`});else P.Z.emit("push-message",{style:"danger",title:"錯誤訊息",content:`請輸入${this.productFieldInfo.title}`})},openModal(){this.productModal.show()},closeModal(){this.productModal.hide()}},mounted(){this.productModal=new(Kt())(this.$refs.productModal,{keyboard:!1,backdrop:"static"})}};const Jt=(0,I.Z)(Wt,[["render",qt]]);var Ot=Jt;const St={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},Et={class:"modal-dialog"},jt={class:"modal-content border-0"},Bt=(0,l._)("div",{class:"modal-header bg-danger text-white"},[(0,l._)("h5",{id:"delProductModalLabel",class:"modal-title"},[(0,l._)("span",null,"刪除產品")]),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Gt={class:"modal-body"},Qt=(0,l.Uk)(" 是否刪除 "),Rt={class:"text-danger"},Tt=(0,l.Uk)(" 商品(刪除後將無法恢復)。 "),Xt={class:"modal-footer"},te=(0,l._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function ee(t,e,a,o,d,i){return(0,l.wg)(),(0,l.iD)("div",St,[(0,l._)("div",Et,[(0,l._)("div",jt,[Bt,(0,l._)("div",Gt,[Qt,(0,l._)("strong",Rt,(0,s.zw)(t.tempProduct.title),1),Tt]),(0,l._)("div",Xt,[te,(0,l._)("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=(...t)=>i.delProduct&&i.delProduct(...t))}," 確認刪除 ")])])])],512)}const ae={get:"get",post:"post",put:"put",delete:"delete"};var le={props:["temp-product","current-page"],methods:{delProduct(){const t=`https://vue3-course-api.hexschool.io/v2/api/202201-vue-shaoyu/admin/product/${this.tempProduct.id}`;P.Z.emit("Loading",!0),this.$http[ae.delete](t).then((t=>{P.Z.emit("push-message",{style:"success",title:"刪除狀態",content:t.data.message}),this.closeModal(),P.Z.emit("changePagesHandler",this.currentPage)})).catch((t=>{P.Z.emit("push-message",{style:"danger",title:"錯誤訊息",content:t.data.message})})).finally((()=>{P.Z.emit("Loading",!1)}))},openModal(){this.delProductModal.show()},closeModal(){this.delProductModal.hide()}},mounted(){this.delProductModal=new(Kt())(this.$refs.delProductModal,{keyboard:!1,backdrop:"static"})}};const se=(0,I.Z)(le,[["render",ee]]);var oe=se,de={data(){return{tempProduct:{},state:"",stateMode:{add:"add",edit:"edit",delete:"delete"},isLoading:!1,products:[],pagination:{},currentPage:1}},components:{Pagination:L,ProductAddModal:Ot,ProductDelModal:oe},methods:{getData(t=1){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/v2/api/202201-vue-shaoyu/admin/products?page=${t}`;this.$http.get(e).then((e=>{const{products:a,pagination:l}=e.data;this.products=a,this.pagination=l,this.currentPage=t})).catch((t=>{P.Z.emit("push-message",{style:"danger",title:"錯誤訊息",content:t.data.message})})).finally((()=>{this.isLoading=!1}))},onLoading(t){this.isLoading=t},openModal(t,e){this.state=t,t===this.stateMode.add?(this.tempProduct={imagesUrl:[]},this.$refs.productAddModal.openModal()):t===this.stateMode.edit?(this.tempProduct=JSON.parse(JSON.stringify(e)),this.$refs.productAddModal.openModal()):t===this.stateMode.delete&&(this.tempProduct={...e},this.$refs.productDelModal.openModal())}},watch:{isLoading(){P.Z.emit("Loading",this.isLoading)}},mounted(){this.getData(),P.Z.on("changePagesHandler",(t=>{this.getData(t)}))}};const ie=(0,I.Z)(de,[["render",f]]);var re=ie}}]);
//# sourceMappingURL=99.7370d3e2.js.map